<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>51.0</apiVersion>
    <assignments>
        <name>Activity_Type_U</name>
        <label>Activity Type U</label>
        <locationX>210</locationX>
        <locationY>574</locationY>
        <assignmentItems>
            <assignToReference>varActivityType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>U</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Find_Existing_WO</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Activity_Type_Z</name>
        <label>Activity Type Z</label>
        <locationX>145</locationX>
        <locationY>476</locationY>
        <assignmentItems>
            <assignToReference>varActivityType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Z</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Comments</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_to_collection</name>
        <label>Add to collection</label>
        <locationX>1370</locationX>
        <locationY>354</locationY>
        <assignmentItems>
            <assignToReference>rcInspectionStepsNew</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>varNewInspectionStep</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Inspection_Steps_Loop</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Copy_Inspection_Step_to_new_record</name>
        <label>Copy Inspection Step to new record</label>
        <locationX>1124</locationX>
        <locationY>345</locationY>
        <assignmentItems>
            <assignToReference>varNewInspectionStep.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Inspection_Steps_Loop.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewInspectionStep.HRCFSL_Input__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Inspection_Steps_Loop.HRCFSL_Input__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewInspectionStep.HRCFSL_Sequence__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Inspection_Steps_Loop.HRCFSL_Sequence__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewInspectionStep.HRCFSL_Work_Order__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>varNewWorkOrder</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varNewInspectionStep.HRCFSL_Short_Description__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Inspection_Steps_Loop.HRCFSL_Short_Description__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_SA_Status</name>
        <label>Update SA Status</label>
        <locationX>1293</locationX>
        <locationY>904</locationY>
        <assignmentItems>
            <assignToReference>Get_SQP_Appointment.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Canceled</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Get_Current_Work_Order.HRCFSL_Comments__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Created new PM work order {!Get_New_Work_Order.WorkOrderNumber}</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Cancel_Notes_on_WO</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>Choice_SQU</name>
        <choiceText>Rental PM - SQU</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>SQU</stringValue>
        </value>
    </choices>
    <choices>
        <name>Choice_SQZ</name>
        <choiceText>Rental Repair - SQZ</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>SQZ</stringValue>
        </value>
    </choices>
    <decisions>
        <name>Comments_entered</name>
        <label>Comments entered?</label>
        <locationX>559</locationX>
        <locationY>712</locationY>
        <defaultConnector>
            <targetReference>Get_New_Work_Order</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Comments_Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>text_Comments</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Note</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>New_WO_Type</name>
        <label>New WO Type</label>
        <locationX>689</locationX>
        <locationY>394</locationY>
        <defaultConnector>
            <targetReference>Create_Platform_Event</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>New_WO_SQU</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Choose_work_type_to_create</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SQU</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Inspection_Steps</targetReference>
            </connector>
            <label>SQU</label>
        </rules>
    </decisions>
    <decisions>
        <name>Open_WO_Found</name>
        <label>Open WO Found</label>
        <locationX>209</locationX>
        <locationY>717</locationY>
        <defaultConnector>
            <targetReference>Create_Work_Order</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Found_Open_WO</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Find_Existing_WO</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Found_Open_WO_Screen</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>PM_PDI_Process</name>
        <label>PM/PDI Process?</label>
        <locationX>423</locationX>
        <locationY>212</locationY>
        <defaultConnector>
            <targetReference>Stop_message</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>PM_PDI_Yes</name>
            <conditionLogic>1 AND (2 OR 3)</conditionLogic>
            <conditions>
                <leftValueReference>Get_Enabled_Countries.HRCFSL_Component_Detail__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Get_Current_Work_Order.Country</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Current_Work_Order.HRCFSL_Work_Type_Name__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SQP</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Current_Work_Order.HRCFSL_Work_Type_Name__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SQU</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Work_Type</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Steps_found</name>
        <label>Steps found?</label>
        <locationX>973</locationX>
        <locationY>663</locationY>
        <defaultConnector>
            <targetReference>Get_SQP_Appointment</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>StepsFound_Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>rcInspectionSteps</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Inspection_Steps_Loop</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Work_Type</name>
        <label>Work Type</label>
        <locationX>182</locationX>
        <locationY>214</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>SQP</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Current_Work_Order.HRCFSL_Work_Type_Name__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SQP</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SQP_Screen</targetReference>
            </connector>
            <label>SQP</label>
        </rules>
        <rules>
            <name>SQU</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Current_Work_Order.HRCFSL_Work_Type_Name__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SQU</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>SQU_Screen</targetReference>
            </connector>
            <label>SQU</label>
        </rules>
    </decisions>
    <decisions>
        <name>Work_Type_Selected</name>
        <label>Work Type Selected</label>
        <locationX>428</locationX>
        <locationY>468</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>SQZ_Selected</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Choose_work_type_to_create</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SQZ</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Activity_Type_Z</targetReference>
            </connector>
            <label>SQZ</label>
        </rules>
        <rules>
            <name>SQU_Selected</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Choose_work_type_to_create</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SQU</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Confirm_SQU_Screen</targetReference>
            </connector>
            <label>SQU</label>
        </rules>
    </decisions>
    <interviewLabel>Create PM / Repair {!$Flow.CurrentDateTime}</interviewLabel>
    <label>HRCFSL Create PM / Repair</label>
    <loops>
        <name>Inspection_Steps_Loop</name>
        <label>Inspection Steps Loop</label>
        <locationX>979</locationX>
        <locationY>497</locationY>
        <collectionReference>rcInspectionSteps</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Copy_Inspection_Step_to_new_record</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_Inspection_Steps</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Create_Document_Link</name>
        <label>Create Document Link</label>
        <locationX>561</locationX>
        <locationY>952</locationY>
        <connector>
            <targetReference>Get_New_Work_Order</targetReference>
        </connector>
        <inputAssignments>
            <field>ContentDocumentId</field>
            <value>
                <elementReference>Create_Note</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>LinkedEntityId</field>
            <value>
                <elementReference>varNewWorkOrder</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ShareType</field>
            <value>
                <stringValue>V</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Visibility</field>
            <value>
                <stringValue>AllUsers</stringValue>
            </value>
        </inputAssignments>
        <object>ContentDocumentLink</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Inspection_Steps</name>
        <label>Create Inspection Steps</label>
        <locationX>1144</locationX>
        <locationY>746</locationY>
        <connector>
            <targetReference>Get_SQP_Appointment</targetReference>
        </connector>
        <inputReference>rcInspectionStepsNew</inputReference>
    </recordCreates>
    <recordCreates>
        <name>Create_Note</name>
        <label>Create Note</label>
        <locationX>565</locationX>
        <locationY>832</locationY>
        <connector>
            <targetReference>Create_Document_Link</targetReference>
        </connector>
        <inputAssignments>
            <field>Content</field>
            <value>
                <elementReference>text_Comments</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>SharingPrivacy</field>
            <value>
                <stringValue>N</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Title</field>
            <value>
                <stringValue>Repair Notes</stringValue>
            </value>
        </inputAssignments>
        <object>ContentNote</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Platform_Event</name>
        <label>Create Platform Event</label>
        <locationX>884</locationX>
        <locationY>362</locationY>
        <connector>
            <targetReference>Success</targetReference>
        </connector>
        <inputAssignments>
            <field>HRCFSL_Work_Order__c</field>
            <value>
                <elementReference>Get_New_Work_Order.Id</elementReference>
            </value>
        </inputAssignments>
        <object>HRCFSL_Outbound_JDE_Work_Order__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Work_Order</name>
        <label>Create Work Order</label>
        <locationX>415</locationX>
        <locationY>710</locationY>
        <assignRecordIdToReference>varNewWorkOrder</assignRecordIdToReference>
        <connector>
            <targetReference>Comments_entered</targetReference>
        </connector>
        <inputAssignments>
            <field>AssetId</field>
            <value>
                <elementReference>Get_Current_Work_Order.AssetId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>EndDate</field>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Activity_Type__c</field>
            <value>
                <elementReference>varActivityType</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Actual_End__c</field>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Actual_Start__c</field>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Assigned_Engineer__c</field>
            <value>
                <elementReference>$User.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Auto_Generate_SA__c</field>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Contact_Department__c</field>
            <value>
                <elementReference>Get_Current_Work_Order.HRCFSL_Contact_Department__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Contact_Email__c</field>
            <value>
                <elementReference>Get_Current_Work_Order.HRCFSL_Contact_Email__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Contact_First_Name__c</field>
            <value>
                <elementReference>Get_Current_Work_Order.HRCFSL_Contact_First_Name__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Contact_Last_Name__c</field>
            <value>
                <elementReference>Get_Current_Work_Order.HRCFSL_Contact_Last_Name__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Contact_Phone__c</field>
            <value>
                <elementReference>Get_Current_Work_Order.HRCFSL_Contact_Phone__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Contact_Title__c</field>
            <value>
                <elementReference>Get_Current_Work_Order.HRCFSL_Contact_Title__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Doc_Type__c</field>
            <value>
                <stringValue>SQ</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HRCFSL_Repair_Notes__c</field>
            <value>
                <elementReference>text_Comments</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>LocationId</field>
            <value>
                <elementReference>Get_Current_Work_Order.LocationId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>PM_Repair_from_PM_PDI__c</field>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>StartDate</field>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </inputAssignments>
        <object>WorkOrder</object>
    </recordCreates>
    <recordLookups>
        <name>Find_Existing_WO</name>
        <label>Find Existing WO</label>
        <locationX>50</locationX>
        <locationY>572</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Open_WO_Found</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AssetId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Current_Work_Order.AssetId</elementReference>
            </value>
        </filters>
        <filters>
            <field>HRCFSL_Doc_Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>SQ</stringValue>
            </value>
        </filters>
        <filters>
            <field>HRCFSL_Activity_Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varActivityType</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>SE</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>SP</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>SC</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>WorkOrder</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Current_Work_Order</name>
        <label>Get Current Work Order</label>
        <locationX>639</locationX>
        <locationY>210</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Enabled_Countries</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>WorkOrder</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Enabled_Countries</name>
        <label>Get Enabled Countries</label>
        <locationX>536</locationX>
        <locationY>210</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>PM_PDI_Process</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Countries_Enabled_for_PM_PDI</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>HRCFSL_Organization_Settings__mdt</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Inspection_Steps</name>
        <label>Get Inspection Steps</label>
        <locationX>810</locationX>
        <locationY>491</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Steps_found</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>HRCFSL_Work_Order__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Current_Work_Order.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>HRCFSL_Sequence__c</field>
            <operator>GreaterThanOrEqualTo</operator>
            <value>
                <numberValue>151.0</numberValue>
            </value>
        </filters>
        <filters>
            <field>HRCFSL_Sequence__c</field>
            <operator>LessThanOrEqualTo</operator>
            <value>
                <numberValue>153.0</numberValue>
            </value>
        </filters>
        <object>HRCFSL_Inspection_Step__c</object>
        <outputReference>rcInspectionSteps</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Name</queriedFields>
        <queriedFields>HRCFSL_Sequence__c</queriedFields>
        <queriedFields>HRCFSL_Input__c</queriedFields>
        <queriedFields>HRCFSL_Short_Description__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_New_Work_Order</name>
        <label>Get New Work Order</label>
        <locationX>869</locationX>
        <locationY>772</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>New_WO_Type</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>varNewWorkOrder</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>WorkOrder</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_SQP_Appointment</name>
        <label>Get SQP Appointment</label>
        <locationX>978</locationX>
        <locationY>856</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Update_SA_Status</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>HRCFSL_Work_Order__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <filters>
            <field>StatusCategory</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>CannotComplete</stringValue>
            </value>
        </filters>
        <filters>
            <field>StatusCategory</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </filters>
        <filters>
            <field>StatusCategory</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Canceled</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>ServiceAppointment</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Cancel_existing_SA</name>
        <label>Cancel existing SA</label>
        <locationX>1302</locationX>
        <locationY>737</locationY>
        <connector>
            <targetReference>Create_Platform_Event</targetReference>
        </connector>
        <inputReference>Get_SQP_Appointment</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Cancel_Notes_on_WO</name>
        <label>Update Cancel Notes on WO</label>
        <locationX>1466</locationX>
        <locationY>807</locationY>
        <connector>
            <targetReference>Cancel_existing_SA</targetReference>
        </connector>
        <inputReference>Get_Current_Work_Order</inputReference>
    </recordUpdates>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <screens>
        <name>Comments</name>
        <label>Comments</label>
        <locationX>26</locationX>
        <locationY>455</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Find_Existing_WO</targetReference>
        </connector>
        <fields>
            <name>text_Comments</name>
            <fieldText>Comments</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Confirm_SQU_Screen</name>
        <label>Confirm SQU Screen</label>
        <locationX>437</locationX>
        <locationY>603</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Activity_Type_U</targetReference>
        </connector>
        <fields>
            <name>Create_PM_confirmation</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;color: rgb(255, 0, 0);&quot;&gt;WARNING!&lt;/b&gt; If you choose to continue, a new PM work order will be created for this asset and the &lt;b&gt;&lt;u&gt;existing BPI work order will be cancelled&lt;/u&gt;&lt;/b&gt;!&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Found_Open_WO_Screen</name>
        <label>Found Open WO Screen</label>
        <locationX>218</locationX>
        <locationY>872</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>Open_WO_Found_Text</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;color: rgb(255, 0, 0);&quot;&gt;Cannot create work order!&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Another open {!Find_Existing_WO.HRCFSL_Work_Type_Name__c} work order exists for this asset: &lt;a href=&quot;/{!Find_Existing_WO.Id}&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;{!Find_Existing_WO.WorkOrderNumber}&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>SQP_Screen</name>
        <label>SQP Screen</label>
        <locationX>293</locationX>
        <locationY>366</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Work_Type_Selected</targetReference>
        </connector>
        <fields>
            <name>Choose_work_type_to_create</name>
            <choiceReferences>Choice_SQU</choiceReferences>
            <choiceReferences>Choice_SQZ</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Choose work type to create</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>SQU_Screen</name>
        <label>SQU Screen</label>
        <locationX>45</locationX>
        <locationY>319</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Activity_Type_Z</targetReference>
        </connector>
        <fields>
            <name>SQU_Text</name>
            <fieldText>&lt;p&gt;You can only create Repair work orders (SQZ) from a PM (SQU) work order.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;If you choose to continue, a new SQZ work order will be created for this asset,&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Stop_message</name>
        <label>Stop message</label>
        <locationX>429</locationX>
        <locationY>333</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>Stop_Message_Text</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;color: rgb(255, 0, 0);&quot;&gt;Function not available&lt;/b&gt;. Please follow your normal process to create work orders.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Success</name>
        <label>Success</label>
        <locationX>888</locationX>
        <locationY>232</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>New_WO_Created</name>
            <fieldText>&lt;p&gt;Work Order &lt;a href=&quot;/lightning/r/WorkOrder/{!varNewWorkOrder}/view&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;{!Get_New_Work_Order.WorkOrderNumber}&lt;/a&gt; created!&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>331</locationX>
        <locationY>50</locationY>
        <connector>
            <targetReference>Get_Current_Work_Order</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>rcInspectionSteps</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>HRCFSL_Inspection_Step__c</objectType>
    </variables>
    <variables>
        <name>rcInspectionStepsNew</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>HRCFSL_Inspection_Step__c</objectType>
    </variables>
    <variables>
        <name>recNewWorkOrder</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WorkOrder</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varActivityType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>varNewInspectionStep</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>HRCFSL_Inspection_Step__c</objectType>
    </variables>
    <variables>
        <name>varNewWorkOrder</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
